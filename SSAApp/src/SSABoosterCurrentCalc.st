program SSABoosterCurrentCalc

#define CURRENTS_NUM 272
#define DELAY_SECONDS 2.0

double totalCurrent = 0;
assign totalCurrent to "{prefix}:RF-SSAmpTower:DCCurrent-Mon";

double currents[CURRENTS_NUM];
assign currents to {
    "{prefix}:RF-SSAmp-H01M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H01M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H01M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H02M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H02M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H03M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H03M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H04M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H04M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H05M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H05M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H06M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H06M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H07M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H07M17:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M01:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M01:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M02:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M02:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M03:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M03:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M04:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M04:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M05:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M05:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M06:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M06:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M07:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M07:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M08:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M08:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M09:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M09:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M10:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M10:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M11:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M11:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M12:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M12:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M13:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M13:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M14:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M14:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M15:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M15:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M16:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M16:Current2-Mon",
    "{prefix}:RF-SSAmp-H08M17:Current1-Mon",
    "{prefix}:RF-SSAmp-H08M17:Current2-Mon" };


float totalAux = 0.0;
int idx = 0;
ss calcTotal {
    state prepareReadings {
        entry {
            totalAux = 0.0;
        }
        when(delay(DELAY_SECONDS)) {
            for(idx = 0; idx < CURRENTS_NUM; idx++) {
                pvGet(currents[idx], SYNC);
                totalAux += currents[idx];
            }
            totalCurrent = totalAux;
        } state assignValue
    }

    state assignValue {
        entry {
            pvPut(totalCurrent, SYNC);
        }
        when(delay(0.1)) {
        } state prepareReadings
    }
}

